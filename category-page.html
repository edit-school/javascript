<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Category Page</title>
  <link rel="stylesheet" href="css/reset.css">
  <link rel="stylesheet" href="css/styles.css">
  
</head>
<body>

  <header>
    <nav class="navbar">
      <a class="logo" href="index.html">
        <img src="assets/edit-extended-logo.png" alt="">
      </a>
      <ul class="menu">
        <li class="menu__item">
          <h6>Seating</h6> 
          <div class="dropdown">
            <div class="row dropdown__megamenu">
              <div class="col-lg-2 dropdown__submenu">
                <h6>Shop by Category</h6>
                <a href="category-page.html">Sectionals</a>
                <a href="category-page.html">Sofas</a>
                <a href="category-page.html">Loveseats</a>
                <a href="category-page.html">Accent Chairs</a>
                <a href="category-page.html">Sleepers</a>
                <a href="category-page.html">Sleep Kits</a>
                <a href="category-page.html">Ottomans</a>
                <a href="category-page.html">Seating Accessories</a>
                <a href="category-page.html">All Seating</a>
              </div>
              <div class="col-lg-2 dropdown__submenu">
                <h6>Shop by Collection</h6>
                <a href="category-page.html">NOMAD Collection</a>
                <a href="category-page.html">Field Collection</a>
                <a href="category-page.html">Range Collection</a>
                <a href="category-page.html">Union Collection</a>
                <a href="category-page.html">NEW</a>
                <a href="category-page.html">Compare Collections</a>
              </div>
              <div class="col-lg-2 dropdown__submenu">
                <h6>Shop by Upholstery</h6>
                <a href="category-page.html">Performance Fabric Seating</a>
                <a href="category-page.html">Italian Leather Seating</a>
                <a href="category-page.html">Performance Velvet Seating</a>
                <a href="category-page.html">All Seating</a>
              </div>
            </div>
          </div>
        </li>
        <li class="menu__item">
          <h6>Living</h6> 
          <div class="dropdown">
            <div class="row">
              <div class="col-lg-2 dropdown__submenu">
                <h6>Shop by Category</h6>
                <a>Sectionals</a>
                <a>Sofas</a>
                <a>Loveseats</a>
                <a>Accent Chairs</a>
                <a>Sleepers</a>
                <a>Sleep Kits</a>
                <a>Ottomans</a>
                <a>Seating Accessories</a>
                <a>All Seating</a>
              </div>
              <div class="col-lg-2 dropdown__submenu">
                <h6>Tables, Carts & Benches</h6>
                <a>Coffee Tables</a>
                <a>Side Tables</a>
                <a>Bar Carts</a>
                <a>Benches</a>
                <a>All Tables & Carts</a>
              </div>
              <div class="col-lg-2 dropdown__submenu">
                <h6>Accessories</h6>
                <a>Seating Accessories</a>
                <a>Throw Pillows</a>
                <a>Throw Blankets</a>
                <a>Trays</a>
                <a>Lighting</a>
                <a>Clearance</a>
                <a>All Accessories</a>
              </div>
            </div>
          </div>
          
        </li>
        <li class="menu__item"><h6>Outdoor</h6></li>
        <li class="menu__item"><h6>Bedroom</h6></li>
        <li class="menu__item"><h6>Storage</h6></li>
      </ul>
      <div class="hamburger_menu">
        <a href="">
          <div class="hamburger_menu__line"></div>
          <div class="hamburger_menu__line"></div>
          <div class="hamburger_menu__line"></div>
        </a>
      </div>
    </nav>
  </header>

  <main>
    <section class="container">
      <div id="products_board" class="row category__header">
        <div class="col-lg-12 category__header__item">
          <h2 id="category_title">All Seating</h2>
        </div>
        <div class="col-lg-12 category__header__item">
          <p>The main feature of any living room is always going to be the seating. Pick and choose your seating styles to build the perfect place to relax. Unwind by yourself, spend time with your family, or entertain guests, all in ultimate comfort.</p>
        </div>
      </div>
      <div class="row category__products">
        <div class="col-lg-4 card">
          <a href="product-page.html">
            <div class="card_header">
              <img class="rollover" src="assets/products/1/product-hover.webp"/>
              <img src="assets/products/1/product.webp"/>
            </div>
            <div class="card_label">
              <h6>Nomad Sofa</h6>
              <span>$1595 or as low as $100/mo</span>
            </div>
          </a>
        </div>
        <div class="col-lg-4 card">
          <a href="product-page.html">
            <div class="card_header">
              <img class="rollover" src="assets/products/2/product-hover.webp"/>
              <img src="assets/products/2/product.webp"/>
            </div>
            <div class="card_label">
              <h6>Nomad Sofa</h6>
              <span>$1595 or as low as $100/mo</span>
            </div>
          </a>
        </div>
        <div class="col-lg-4 card">
          <a href="product-page.html">
            <div class="card_header">
              <img class="rollover" src="assets/products/3/product-hover.webp"/>
              <img src="assets/products/3/product.webp"/>
            </div>
            <div class="card_label">
              <h6>Nomad Sofa</h6>
              <span>$1595 or as low as $100/mo</span>
            </div>
          </a>
        </div>
        <div class="col-lg-4 card">
          <a href="product-page.html">
            <div class="card_header">
              <img class="rollover" src="assets/products/4/product-hover.webp" alt="Nomad Sofa"/>
              <img src="assets/products/4/product.webp" alt="Nomad Sofa"/>
            </div>
            <div class="card_label">
              <h6>Nomad Sofa</h6>
              <span>$1595 or as low as $100/mo</span>
            </div>
          </a>
        </div>
        <div class="col-lg-4 card">
          <a href="product-page.html">
            <div class="card_header">
              <img class="rollover" src="assets/products/5/product-hover.webp" alt="Nomad Sofa"/>
              <img src="assets/products/5/product.webp" alt="Nomad Sofa"/>
            </div>
            <div class="card_label">
              <h6>Nomad Sofa</h6>
              <span>$1595 or as low as $100/mo</span>
            </div>
          </a>
        </div>
        <div class="col-lg-4 card">
          <a href="product-page.html">
            <div class="card_header">
              <img class="rollover" src="assets/products/6/product-hover.webp" alt="Nomad Sofa"/>
              <img src="assets/products/6/product.webp" alt="Nomad Sofa"/>
            </div>
            <div class="card_label">
              <h6>Nomad Sofa</h6>
              <span>$1595 or as low as $100/mo</span>
            </div>
          </a>
        </div>
        <div class="col-lg-4 card">
          <a href="product-page.html">
            <div class="card_header">
              <img class="rollover" src="assets/products/7/product-hover.webp" alt="Nomad Sofa"/>
              <img src="assets/products/7/product.webp" alt="Nomad Sofa"/>
            </div>
            <div class="card_label">
              <h6>Nomad Sofa</h6>
              <span>$1595 or as low as $100/mo</span>
            </div>
          </a>
        </div>
        <div class="col-lg-4 card">
          <a href="product-page.html">
            <div class="card_header">
              <img class="rollover" src="assets/products/8/product-hover.webp" alt="Nomad Sofa"/>
              <img src="assets/products/8/product.webp" alt="Nomad Sofa"/>
            </div>
            <div class="card_label">
              <h6>Nomad Sofa</h6>
              <span>$1595 or as low as $100/mo</span>
            </div>
          </a>
        </div>
        <div class="col-lg-4 card">
          <a href="product-page.html">
            <div class="card_header">
              <img class="rollover" src="assets/products/2/product-hover.webp" alt="Nomad Sofa"/>
              <img src="assets/products/2/product.webp" alt="Nomad Sofa"/>
            </div>
            <div class="card_label">
              <h6>Nomad Sofa</h6>
              <span>$1595 or as low as $100/mo</span>
            </div>
          </a>
        </div>
      </div>
    </section>

    <section class="container--fluid bg_secondary">
      <div class="carousel_container">
        <h2>The Best Rated Products</h2>
        <div id="slides_container"></div>
        <span class="prev" onclick="plusSlides(-1)">&#10094;</span>
        <span class="next" onclick="plusSlides(1)">&#10095;</span>
        <div id="dots_container" style="text-align:center"></div>
      </div>
    </section>

    <section class="container">
      <div class="row search_screen">
        <div class="col-lg-12">
          <form id="searchbar" class="searchbar">
            <input type="text" name="searchField" required minlength="2" placeholder="Type Your Search Words Here" />
            <button type="submit" class="btn bg_secondarydark">SEARCH</button>
          </form>
        </div>
      </div> 
      <div class="row">
        <div id="search_board"></div>
      </div>    
    </section>
  </main>

  <footer>
    <div class="container--fluid">
      <div class="social_media bg_secondarydark">
        <form id="subscribeForm" class="subscription">
          <input class="bg_secondarydark" type="email" name="emailField" placeholder="Sign Up For Some Couch Reads" />
          <button type="submit" class="btn bg_secondary">SUBSCRIBE</button>
        </form>
        <div class="icons">
          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0,0,256,256" width="30px" height="30px" fill-rule="nonzero"><g fill-opacity="0" fill="#dddddd" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><path d="M0,256v-256h256v256z" id="bgRectangle"></path></g><g fill="#ffffff" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><g transform="scale(8.53333,8.53333)"><path d="M15,4c-4.186,0 -9.61914,1.04883 -9.61914,1.04883l-0.01367,0.01563c-1.90652,0.30491 -3.36719,1.94317 -3.36719,3.93555v6v0.00195v5.99805v0.00195c0.00384,1.96564 1.4353,3.63719 3.37695,3.94336l0.00391,0.00586c0,0 5.43314,1.05078 9.61914,1.05078c4.186,0 9.61914,-1.05078 9.61914,-1.05078l0.00195,-0.00195c1.94389,-0.30554 3.37683,-1.97951 3.37891,-3.94727v-0.00195v-5.99805v-0.00195v-6c-0.00288,-1.96638 -1.43457,-3.63903 -3.37695,-3.94531l-0.00391,-0.00586c0,0 -5.43314,-1.04883 -9.61914,-1.04883zM12,10.39844l8,4.60156l-8,4.60156z"></path></g></g></svg>
          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0,0,256,256" width="30px" height="30px" fill-rule="nonzero"><g fill-opacity="0" fill="#000000" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><path d="M0,256v-256h256v256z" id="bgRectangle"></path></g><g fill="#ffffff" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><g transform="scale(8.53333,8.53333)"><path d="M9.99805,3c-3.859,0 -6.99805,3.14195 -6.99805,7.00195v10c0,3.859 3.14195,6.99805 7.00195,6.99805h10c3.859,0 6.99805,-3.14195 6.99805,-7.00195v-10c0,-3.859 -3.14195,-6.99805 -7.00195,-6.99805zM22,7c0.552,0 1,0.448 1,1c0,0.552 -0.448,1 -1,1c-0.552,0 -1,-0.448 -1,-1c0,-0.552 0.448,-1 1,-1zM15,9c3.309,0 6,2.691 6,6c0,3.309 -2.691,6 -6,6c-3.309,0 -6,-2.691 -6,-6c0,-3.309 2.691,-6 6,-6zM15,11c-2.20914,0 -4,1.79086 -4,4c0,2.20914 1.79086,4 4,4c2.20914,0 4,-1.79086 4,-4c0,-2.20914 -1.79086,-4 -4,-4z"></path></g></g></svg>
          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0,0,256,256" width="30px" height="30px" fill-rule="nonzero"><g fill="#ffffff" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><g transform="scale(8.53333,8.53333)"><path d="M15,3c-6.627,0 -12,5.373 -12,12c0,6.016 4.432,10.984 10.206,11.852v-8.672h-2.969v-3.154h2.969v-2.099c0,-3.475 1.693,-5 4.581,-5c1.383,0 2.115,0.103 2.461,0.149v2.753h-1.97c-1.226,0 -1.654,1.163 -1.654,2.473v1.724h3.593l-0.487,3.154h-3.106v8.697c5.857,-0.794 10.376,-5.802 10.376,-11.877c0,-6.627 -5.373,-12 -12,-12z"></path></g></g></svg>
        </div>
      </div>
      <div class="container--fluid bg_primarydark">
        <div class="row footer_menu">
          <div class="col-lg-3 footer_menu__submenu">
            <h6>Shopping Services</h6> 
            <a>Schedule Consultation</a>  
            <a>Showrooms </a>
            <a>Trade Program</a> 
            <a>Outlet</a>
          </div>
          <div class="col-lg-3 footer_menu__submenu">
            <h6>About</h6> 
            <a>Our Story</a>  
            <a>Reviews</a>
            <a>Careers</a> 
            <a>Financing</a>
            <a>Patents</a>
            <a>Our Blog</a>
          </div>
          <div class="col-lg-3 footer_menu__submenu">
            <h6>Resources</h6> 
            <a>Look Up Order Status</a>  
            <a>Assembly Instructions</a>
            <a>Returns</a> 
            <a>Shipping & Delivery</a>
            <a>FAQ</a>
            <a>Refer a Friend</a>
          </div>
          <div class="col-lg-3 footer_menu__submenu">
            <h6>Contact Customer Experience</h6> 
            <a>Email: support@template.com</a>  
            <a>Text: 224-628-7769</a>
            <a>Hours:</a> 
            <a>Monday to Friday - 10a to 8p EST</a>
            <a>Saturday to SundaY - 10a to 2p EST</a>
          </div>
        </div>
        <div class="row footer_info">
          <div class="col-lg-3 footer_info__item">
            <span id="copyrights">© 2023 Template</span>  
            <a>Terms - Accessibility - Sitemap - Privacy</a>
          </div>
          <div class="col-lg-6"></div>
          <div class="col-lg-3 footer_info__item">
            <span>15 W 27th Street, 9th Floor New York, NY, 10001</span>
          </div>
        </div>
      </div>
    </div>
  </footer>
  
  <script type="text/javascript" src="./reusables.js"></script>
  <script>

    // Products

    removeDefaultProducts = async () => {
      const boardContent = Array.from(document.getElementsByClassName("card"));
      for (k = 0; k < boardContent.length; k++) {
          boardContent[k].remove();
      }
      const categoryTitle = document.getElementById("category_title");
      categoryTitle.innerHTML = "";
    }  
    removeDefaultProducts();

    const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);
    const pageCategory = urlParams.get("category");

    getProducts = async () => {
      fetch(`https://fakestoreapi.com/products/category/${pageCategory}`)
      .then((response) => response.json())
      .then((data) => data);
    
      const response = await fetch(`https://fakestoreapi.com/products/category/${pageCategory}`);
      const data = await response.json();
      const categoryTitle = document.getElementById("category_title");
      categoryTitle.innerHTML = pageCategory;
      const productsBoard = document.getElementById("products_board");

      return data.forEach(element => {
        const categoryDiv = document.createElement("div");
        categoryDiv.innerHTML = 
          `<a href="product-page.html?produtoID=${element.id}">
            <div class="card_header">
              <img src="${element.image}" alt="${element.title} image"/>
            </div>
            <div class="card_label">
              <h6>${element.title}</h6>
              <span>$${element.price}</span>
            </div>
          </a>`;
        categoryDiv.setAttribute("class", "col-lg-5 card");
        productsBoard.append(categoryDiv)
      });
    }
    getProducts();


    // Carousel   
  
    getRatedProducts = async () => {
      fetch(`https://fakestoreapi.com/products/category/${pageCategory}`)
      .then((response) => response.json())
      .then((data) => data);
    
      const response = await fetch(`https://fakestoreapi.com/products/category/${pageCategory}`);
      const data = await response.json();
      const slidesContainer = document.getElementById("slides_container");
      slidesContainer.innerHTML = "";
      
      data.forEach(element => {
        if (element.rating.rate > 3) {
          const productDiv = document.createElement("div");
          productDiv.innerHTML =
            `<a href="product-page.html?produtoID=${element.id}">
              <img class="carousel_image" src="${element.image}">
            </a>
            <div class="text">${element.title}</div>`;
          productDiv.setAttribute("class", "slide fade");
          slidesContainer.append(productDiv);
        }
      });

      const ratedProductsSlides = document.getElementsByClassName("slide fade");
      const dotsContainer = document.getElementById("dots_container");
      dotsContainer.innerHTML = "";

      for (let i = 0; i < ratedProductsSlides.length; i++) {
        const dot = document.createElement("span");
        dot.setAttribute("class", "dot");
        dot.setAttribute("onclick", `currentSlide(${i + 1})`);
        dotsContainer.append(dot);
      }
    }

    showSlides = async (n) => {
      await getRatedProducts();
      let slides = document.getElementsByClassName("slide");
      let dots = document.getElementsByClassName("dot");

      if (n > slides.length) {slideIndex = 1} 
      if (n < 1) {slideIndex = slides.length}

      for (i = 0; i < slides.length; i++) {
        slides[i].style.display = "none"; 
      }

      for (i = 0; i < dots.length; i++) {
        dots[i].className = dots[i].className.replace(" active", "");
      }
      
      slides[slideIndex - 1].style.display = "block"; 
      dots[slideIndex - 1].className += " active";
    }
    
    let slideIndex = 1;

    plusSlides = (n) => {
      showSlides(slideIndex += n);
    }

    currentSlide = (n) => {
      showSlides(slideIndex = n);
    }

    showSlides(slideIndex)

    // Search Bar

    const searchBar = document.getElementById("searchbar");

    searchBar.addEventListener("submit", function(event) {
      event.preventDefault();
      const formData = new FormData(event.target);
      const search = formData.get("searchField").toLowerCase();
      const searchBoard = document.getElementById("search_board");
      searchBoard.innerHTML = "";

      getSearch = async () => {
        fetch(`https://fakestoreapi.com/products/category/${pageCategory}`)
        .then((response) => response.json())
        .then((data) => data);

        const response = await fetch(`https://fakestoreapi.com/products/category/${pageCategory}`);
        const data = await response.json();
        const result = [];

        data.forEach(element => {
          if (element.title.toLowerCase().includes(search) == true || element.description.toLowerCase().includes(search) == true) {
            result.push(element);
          }
        });

        result.forEach(element => {
          const productDiv = document.createElement("div");
          productDiv.innerHTML = 
            `<a href="product-page.html?produtoID=${element.id}">
              <div class="card_header">
                <img src="${element.image}" alt="${element.title} image"/>
              </div>
              <div class="card_label">
                <h6>${element.title}</h6>
                <span>$${element.price}</span>
              </div>
            </a>`;
          productDiv.setAttribute("class", "col-lg-3 card");
          searchBoard.append(productDiv);
          });

          if (result.length == 0) {
            const noResultsMessage = document.createElement("h3");
            noResultsMessage.innerHTML = "No products found. :(";
            searchBoard.append(noResultsMessage);
          }
        }
        getSearch(search);  
    });

  </script>
</body>
</html>